{% extends "base.html" %}

{% block extra_head_content %}
  {{ block.super }}
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/heatmap.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/data.js"></script>
  <script src="https://code.highcharts.com/modules/boost-canvas.js"></script>
  <script src="https://code.highcharts.com/modules/boost.js"></script>
  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="/static/tp/js/charts.js"></script>
  <script src="/static/tp/js/panzoom.js"></script>
{% endblock %}

{% load render_table from django_tables2 %}
{% load bootstrap3 %}

{% block content %}

{% if error_message %}
  <div class="alert alert-danger">
    {{ error_message }}
  </div>
{% endif %}

<section id="control_section" class="panel panel-default">
  <div class="panel panel-body">
    <a href="{% url 'tp:analysis-summary' %}" class="btn btn-primary">Back to summary</a>
    {% if request.session.allow_export %}
    <a href="{% url 'tp:export-filtered-result' %}" class="btn btn-default">Export to Excel</a>
    <button type="button" class="btn btn-default" id="show_viz">Show visualization</button>
    <button type="button" class="btn btn-default hidden" id="hide_viz">Hide visualization</button>
    {% endif %}
    {% if show_tox_result_link %}
    <a href="{% url 'tp:toxicology-results' %}" class="btn btn-default">Toxicology results for similar experiments</a>
    {% endif %}
  </div>

  <div class="filter-dialog panel-body">
    <form class="form" action="" method="get">
      {% bootstrap_form filter.form layout='horizontal' %}
      {% buttons %}
      {% bootstrap_button "Update" button_type="submit" button_class="btn-primary" extra_classes="table_updater" %}
      <a class="btn btn-default" href="{{ request.path }}">Clear</a>
      {% endbuttons %}
    </form>
    <div id="uploadIcon"></div>
  </div>
</section>

<div id="viz_loading"></div>
<div id="viz_error" class="alert alert-warning hidden"></div>

<section id="viz_section" class="panel panel-default hidden">
  <div id="type_buttons" class="panel-body">
    <button id="heatmap" class="btn btn-default">Heatmap</button>
    <button id="mapchart" class="btn btn-default">Map chart</button>
  </div>
  <div class="parent" style="overflow: hidden; position: relative;">
    <div class="panzoom" style="transform: none; transform-origin: 50% 50% 0px;">
      <div id="viz_container" class="viz_container"></div>
    </div>
  </div>
  <div id="zoom_buttons" class="panel-body hidden">
    <button class="btn btn-default zoom-in">Zoom In</button>
    <button class="btn btn-default zoom-out">Zoom Out</button>
    <button class="btn btn-default reset">Reset</button>
  </div>
</section>

{% render_table table %}
{% endblock content %}
